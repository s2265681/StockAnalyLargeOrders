# 🚀 前端环境配置说明

## 📋 概述

前端项目已配置为支持开发环境和生产环境的不同API地址，无需使用代理。

## 🔧 环境配置

### 开发环境
- **API地址**: `http://localhost:9001`
- **端口**: 9000 (前端)
- **调试**: 启用API调试日志

### 生产环境  
- **API地址**: `http://18.141.179.222:9001`
- **端口**: 9000 (前端)
- **调试**: 关闭API调试日志

## 📝 启动命令

### 开发环境启动
```bash
cd frontend
npm start
# 或者
npm run start:dev
```

### 生产环境构建
```bash
cd frontend
npm run build:prod
npm run serve
```

## 🎯 环境变量配置 (可选)

可以通过环境变量自定义API配置：

### 方法1: 创建 .env 文件
```bash
# frontend/.env.development
REACT_APP_API_BASE_URL=http://localhost:9001
REACT_APP_API_TIMEOUT=10000
REACT_APP_DEBUG_API=true

# frontend/.env.production  
REACT_APP_API_BASE_URL=http://18.141.179.222:9001
REACT_APP_API_TIMEOUT=15000
REACT_APP_DEBUG_API=false
```

### 方法2: 命令行设置
```bash
# 开发环境自定义API地址
REACT_APP_API_BASE_URL=http://192.168.1.100:9001 npm start

# 生产环境自定义API地址
REACT_APP_API_BASE_URL=http://your-server.com:9001 npm run build
```

## 🛠️ API配置功能

### 自动环境切换
- 开发环境自动使用 `localhost:9001`
- 生产环境自动使用 `18.141.179.222:9001`

### 调试功能
- 开发环境显示API请求日志
- 生产环境关闭调试日志
- 支持API健康检查

### 错误处理
- 请求超时处理 (开发10秒/生产15秒)
- 网络错误自动重试
- 详细的错误信息提示

## 📊 API接口列表

项目使用的竞品格式接口：

1. **基本信息**: `/api/v1/base_info?code=603001&dt=2025-01-15`
2. **分时数据**: `/api/v1/quote?code=603001&dt=2025-01-15`  
3. **大单明细**: `/api/v1/dadan?code=603001&dt=2025-01-15`
4. **大单统计**: `/api/v1/dadantongji?code=603001&dt=2025-01-15`

## 🔍 调试方法

### 查看API配置
```javascript
// 在浏览器控制台执行
import { getEnvironmentInfo } from './config/api.js';
console.log(getEnvironmentInfo());
```

### API健康检查
```javascript
// 在浏览器控制台执行
import { checkApiHealth } from './config/api.js';
checkApiHealth().then(console.log);
```

## 🚦 部署说明

### 开发部署
```bash
cd frontend
npm install
npm start
# 前端: http://localhost:9000
# API: http://localhost:9001
```

### 生产部署
```bash
cd frontend
npm install
npm run build:prod
npm run serve
# 前端: http://localhost:9000  
# API: http://18.141.179.222:9001
```

## ⚙️ 配置文件说明

### `src/config/api.js`
- API配置管理
- 环境自动切换
- 请求封装和错误处理

### `package.json`
- 删除了 `proxy` 配置
- 添加了生产环境构建脚本
- 支持本地服务器预览

## 🎯 核心特性

✅ **无代理配置**: 直接在代码中管理API地址  
✅ **环境自动切换**: 根据NODE_ENV自动选择API地址  
✅ **灵活配置**: 支持环境变量自定义API地址  
✅ **调试友好**: 开发环境详细日志，生产环境静默  
✅ **错误处理**: 完整的超时和错误处理机制  
✅ **健康检查**: 支持API状态检测  

## 🔄 迁移说明

从之前的代理配置迁移到新配置：

1. ✅ 删除了 `package.json` 中的 `"proxy"` 配置
2. ✅ 创建了 `src/config/api.js` 配置文件  
3. ✅ 更新了 `src/store/atoms.js` 中的API调用
4. ✅ 添加了环境变量支持
5. ✅ 支持开发/生产环境自动切换

现在可以直接使用 `npm start` 开发，使用 `npm run build:prod` 构建生产版本。 